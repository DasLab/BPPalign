<html>
  <head>
    <title>RNAstructure Help -- Appendix A: File Formats</title>
    <link
      href="Styles.css"
      rel="stylesheet"
      type="text/css"
    />
  </head>
  <body>
    <h1>RNAstructure</h1>
    <h2>Version 5.1</h2>
    <h2>Copyright 1996 - 2010</h2>
    <h2>by David H. Mathews</h2>
    <br/>

    <h3>Appendix A: File Formats</h3>

    <p><b><a name="SequenceFileFormat">Sequence File Format</a></b></p>
    <p>A sequence must be saved as a text file with a SEQ extension. The file must have the following format:</p>
    <ol>
      <li>Comment lines must be at the beginning of the file and must start with a semicolon.  There needs to be at least one comment line in the file.</li>
      <li>Any number of comments are allowed, but each line before the title must start with a semicolon.</li>
      <li>After the comments, a title must be given and must be contained on one line.</li>
      <li>The line after the title must start the sequence, entered from 5&#146 to 3&#146. The sequence can be on any number of lines and can contain U or T (T's are translated into U's for RNA). Spaces are allowed in the sequence. Bases should generally be in capital letters. <strong>Lowercase letters can be used to indicate a base that should be single-stranded in the predicted structure.</strong> "XXXX" can be used in the sequence to indicate that some bases have been left out of the prediction.</li>
      <li>Finally, the sequence must end in 1.</li>
    </ol>
    <p>An example of the format is given here:</p>
    <br/>
    <p><i>; (first line of file) Comments must start with a semicolon.</i></p>
    <p><i>;</i></p>
    <p><i>; There can be any number of comments.</i></p>
    <p><i>A title must immediately follow on the next line and be on one line.</i></p>
    <p><i>AAA GCGG UUTGTT UTCUTaaTCTXXXXUCAGG1</i></p>
    <br/>

    <p><b><a name="CTFileFormat">CT File Format</a></b></p>
    <p>A CT (Connectivity Table) file contains secondary structure information for a sequence. These files are saved with a CT extension. When entering a structure to calculate the free energy, the following format must be followed.</p>
    <ol>
      <li>Start of first line: number of bases in the sequence</li>
      <li>End of first line: title of the structure</li>
      <li>Each of the following lines provides information about a given base in the sequence. Each base has its own line, with these elements in order:</li> 
        <ol type=a>
          <li>Base number: index n</li>
          <li>Base (A, C, G, T, U, X)</li>
          <li>Index n-1</li>
          <li>Index n+1</li>
          <li>Number of the base to which n is paired. No pairing is indicated by 0 (zero).</li>
          <li>Natural numbering. RNAstructure ignores the actual value given in natural numbering, so it is easiest to repeat n here.</li>
        </ol>
     </ol>
     <p>The CT file may hold multiple structures for a single sequence. This is done by repeating the format for each structure without any blank lines between structures.</p>
     <br/>
     <p>The CT file format is such that any files generated by RNAstructure are compatible with mfold/unafold and many other software packages.</p>
    <br/>

    <p><b><a name="ConstraintFileFormat">Constraint File Format</a></b></p>
    <p>Folding constraints are saved in plain text with a CON extension. These can be hand edited. For multiple entries of a specific type of constraint, entries are each listed on a separate line. When there is no constraint of a type, there are no lines required. Note that all specifiers, followed by "-1" or "-1 -1", are expected by RNAstructure. The file format is as follows:</p>
    <br/>
    <p><i>DS:</i></p>
    <p><i>XA</i></p>
    <p><i>-1</i></p>
    <p><i>SS:</i></p>
    <p><i>XB</i></p>
    <p><i>-1</i></p>
    <p><i>Mod:</i></p>
    <p><i>XC</i></p>
    <p><i>-1</i></p>
    <p><i>Pairs:</i></p>
    <p><i>XD1 XD2</i></p>
    <p><i>-1 -1</i></p>
    <p><i>FMN:</i></p>
    <p><i>XE</i></p>
    <p><i>-1</i></p>
    <p><i>Forbids:</i></p>
    <p><i>XF1 XF2</i></p>
    <p><i>-1 -1</i></p>
    <ul>
      <li>XA: Nucleotides that will be double-stranded</li>
      <li>XB: Nucleotides that will be single-stranded (unpaired)</li>
      <li>XC: Nucleotides accessible to chemical modification</li>
      <li>XD1, XD2: Forced base pairs</li>
      <li>XE: Nucleotides accessible to FMN cleavage</li>
      <li>XF1, XF2: Prohibited base pairs</li>
    </ul>
    <p>A sample file with constraints is:</p>
    <br/>
    <p><i>DS:</i></p>
    <p><i>15</i></p>
    <p><i>25</i></p>
    <p><i>76</i></p>
    <p><i>-1</i></p>
    <p><i>SS:</i></p>
    <p><i>17</i></p>
    <p><i>18</i></p>
    <p><i>20</i></p>
    <p><i>35</i></p>
    <p><i>-1</i></p>
    <p><i>Mod:</i></p>
    <p><i>2</i></p>
    <p><i>15</i></p>
    <p><i>-1</i></p>
    <p><i>Pairs:</i></p>
    <p><i>16 26</i></p>
    <p><i>-1 -1</i></p>
    <p><i>FMN:</i></p>
    <p><i>-1</i></p>
    <p><i>Forbids:</i></p>
    <p><i>15 27</i></p>
    <p><i>-1 -1</i></p>
    <br>

    <p><b><a name="SHAPEFileFormat">SHAPE Reactivity File Format</a></b></p>
    <p>The file format for SHAPE reactivity comprises two columns. The first column is the nucleotide number, and the second is the reactivity.</p>
    <br/>
    <p>Nucleotides for which there is no SHAPE data can either be left out of the file, or the reactivity can be entered as less than -500. Columns are separated by any white space.</p>
    <br/>
    <p>Note that there is no header information. Nucleotides 1 through 10 have no reactivity information. Nucleotide 11 has a normalized SHAPE reactivity of 0.042816. Nucleotide 12 has a normalized SHAPE reactivity of 0, which is NOT the same as having no reactivity when using the pseudo-energy constraints.</p>
    <br/>
    <p>By default, RNAstructure looks for SHAPE data files to have the file extension SHAPE, but any plain text file can be read. An example of such a file is given below.</p>
    <br/>
    <p><i>9	-999</i></p>
    <p><i>10	-999</i></p>
    <p><i>11	0.042816</i></p>
    <p><i>12	0</i></p>
    <p><i>13	0.15027</i></p>
    <p><i>14	0.16201</i></p>
    <br>

    <p><b><a name="ListFileFormat">List File Format</a></b></p>
    <p>List files have a LIS extension. This file contains any number of sequences of any length or nucleic acid, each on its own line. For example:
    <p><i>CUGAGCCAAG</i></p>
    <p><i>GGGCUCAACG</i></p>
    <p><i>GGCGUGAGAAAC</i></p>
  </body>
</html>
