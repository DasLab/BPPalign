<html>
  <head>
    <title>RNAstructure Text Interfaces Help</title>
    <link
       href="Stylesheet.css"
       rel="stylesheet"
       type="text/css"
    />
  </head>
  <body>
    <div class="bodydiv">
      <table cellpadding="0" cellspacing="0" border="0" class="mainTable">
	<tr class="headerRow">
	  <td class="headerBox">
	    <img src="icon.jpg" alt="RNAstructure logo"/>
	  </td>
	  <td class="headerLabel">
	    <h1>
	      RNAstructure Help
	      <br/>
	      File Formats
	    </h1>
	  </td>
	  <td class="headerBox2">
	    <h3><ul>
	      <li><a href="index.html">Contents</a></li>
	      <li><a href="AlphabeticalIndex.html">Index</a></li>
	    </ul></h3>
	  </td>
	</tr>
	<tr><td colspan="3" align="left" class="mainContent">
	    <p>&nbsp;</p>
        <h1 class="leftHeader"><b>Sequence File Format</b></h1>
        <p>An RNAstructure sequence file has the following format:</p>
        <ol>
          <li>Comment lines must be at the beginning of the file and must start with a semicolon.  There needs to be at least one comment line in the file.</li>
          <li>Any number of comments are allowed, but each line before the title must start with a semicolon.</li>
          <li>After the comments, a title must be given and must be contained on one line. (The title cannot be empty.)</li>
          <li>The line after the title must start the sequence, entered from 5&#146 to 3&#146. The sequence can be on any number of lines and can contain U or T (T's are translated as U's for RNA structure prediction). Spaces are allowed in the sequence. Normal bases must be in capital letters. <strong>Lowercase letters  indicate a base that will be single-stranded in the predicted structure</strong>. "XXXX" can be used in the sequence to indicate that some bases have been left out of the prediction.</li>
          <li>Finally, the sequence must end in 1.</li>
        </ol>
        <p>An example of the format is given here:<br/>
        </p>
        <p>; (first line of file) Comments must start with a semicolon.</i><br/>
 
        <i>; There can be any number of comments.</i><br/>
        <i>A title must immediately follow on the next line and be on one line.</i><br/>
        <i>AAA GCGG UUTGTT UTCUTaaTCTXXXXUCAGG1</i><br/></p>
        <h1>FASTA Sequence File Format</h1>
        <p>Sequences can also be provided to RNAstructure in FASTA format. For FASTA, the first line, a title line, needs to start with &gt;.  Subsequent lines should only contain sequence and whitespace, which is ignored. <strong>Lowercase nucleotides will be forced single stranded in structure prediction.</strong></p>
        <p>&nbsp;</p>
        <p>An example of the format is:</p>
        <p>&gt;Title of Sequence<br/>
        <i>AAA GCGG UUTGTT UTCUTaaTCTXXXXUCAGG</i><br/>
        <i>UUA GCCG UUTGTT UTCUTaaTCTGGG</i></p>
        <p><br/>
        </p>
        <h1><b>CT File Format</b></h1>
        <p>A CT (Connectivity Table) file contains secondary structure information for a sequence. When entering a structure to calculate the free energy, the following format must be followed:</p>
        <ol>
          <li>Start of first line: number of bases in the sequence</li>
          <li>End of first line: title of the structure</li>
          <li>Each of the following lines provides information about a given base in the sequence. Each base has its own line, with these elements in order:</li>
          <ol type=a>
            <li>Base number: index n</li>
            <li>Base (A, C, G, T, U, X)</li>
            <li>Index n-1</li>
            <li>Index n+1</li>
            <li>Number of the base to which n is paired. No pairing is indicated by 0 (zero).</li>
            <li>Natural numbering. RNAstructure ignores the actual value given in natural numbering, so it is easiest to repeat n here.</li>
          </ol>
        </ol>
        <p>The CT file may hold multiple structures for a single sequence. This is done by repeating the format for each structure without any blank lines between structures.</p>
        <br/>
        <p>The CT file format is such that files generated by RNAstructure are compatible with mfold/Unafold, available from Michael Zuker.</p>
        <br/>
        <h1><b>Constraint File Format</b></h1>
        <p>Folding constraints can be specified using plain text files. For multiple entries of a specific type of constraint, entries are each listed on a separate line. When there is no constraint of a type, there are no lines required. Note that all specifiers, followed by "-1" or "-1 -1", are expected by RNAstructure. The file format is as follows:</p>
        <br/>
        <p><i>DS:</i><br/>
        <i>XA</i><br/>
        <i>-1</i><br/>
        <i>SS:</i><br/>
        <i>XB</i><br/>
        <i>-1</i><br/>
        <i>Mod:</i><br/>
        <i>XC</i><br/>
        <i>-1</i><br/>
        <i>Pairs:</i><br/>
        <i>XD1 XD2</i><br/>
        <i>-1 -1</i><br/>
        <i>FMN:</i><br/>
        <i>XE</i><br/>
        <i>-1</i><br/>
        <i>Forbids:</i><br/>
        <i>XF1 XF2</i><br/>
        <i>-1 -1</i></p>
        <ul>
          <li>XA: Nucleotides that will be double-stranded</li>
          <li>XB: Nucleotides that will be single-stranded (unpaired)</li>
          <li>XC: Nucleotides accessible to chemical modification</li>
          <li>XD1, XD2: Forced base pairs</li>
          <li>XE: Nucleotides accessible to FMN cleavage</li>
          <li>XF1, XF2: Prohibited base pairs</li>
        </ul>
        <p>A sample file with constraints is:</p>
        <br/>
        <p><i>DS:</i><br/>
        <i>15</i><br/>
        <i>25</i><br/>
        <i>76</i><br/>
        <i>-1</i><br/>
        <i>SS:</i><br/>
        <i>17</i><br/>
        <i>18</i><br/>
        <i>20</i><br/>
        <i>35</i><br/>
        <i>-1</i><br/>
        <i>Mod:</i><br/>
        <i>2</i><br/>
        <i>15</i><br/>
        <i>-1</i><br/>
        <i>Pairs:</i><br/>
        <i>16 26</i><br/>
        <i>-1 -1</i><br/>
        <i>FMN:</i><br/>
        <i>-1</i><br/>
        <i>Forbids:</i><br/>
        <i>15 27</i><br/>
        <i>-1 -1</i></p>
        <br>
        <h1><b><a name="SHAPEFileFormat">SHAPE Reactivity File Format</a></b></h1>
        <p>The file format for SHAPE reactivity comprises two columns. The first column is the nucleotide number, and the second is the reactivity.</p>
        <br/>
        <p>Nucleotides for which there is no SHAPE data can either be left out of the file, or the reactivity can be entered as less than -500. Columns are separated by any white space.</p>
        <br/>
        <p>Note that there is no header information. Nucleotides 1 through 10 have no reactivity information. Nucleotide 11 has a normalized SHAPE reactivity of 0.042816. Nucleotide 12 has a normalized SHAPE reactivity of 0, which is NOT the same as having no reactivity when using the pseudo-energy constraints.</p>
        <br/>
        <p>By default, RNAstructure looks for SHAPE data files to have the file extension SHAPE, but any plain text file can be read. An example of such a file is given below.</p>
        <br/>
        <p><i>9	-999</i><br/>
        <i>10	-999</i><br/>
        <i>11	0.042816</i><br/>
        <i>12	0</i><br/>
        <i>13	0.15027</i><br/>
        <i>14	0.16201</i></p>
        <br>
        <h1><b><a name="ListFileFormat">List File Format</a></b></h1>
        <p>This file contains any number of sequences of any length or nucleic acid, each on its own line. This is used by the program <a href="oligoscreen.html">oligoscreen</a>. For example:
        <p><i>CUGAGCCAAG</i><br/>
        <i>GGGCUCAACG</i><br/>
       <i>GGCGUGAGAAAC</i></p>
<h2 class="leftHeader">&nbsp;</h2><dl class="noBottomMargin">
  <dt>&nbsp;</dt>
</dl>
	</td></tr>
	<tr><td class="footer" colspan="3">
	  <p>
	    Visit
	    <a href="http://rna.urmc.rochester.edu/RNAstructure.html">
	      The Mathews Lab RNAstructure Page</a>
	    for updates and latest information.
	  </p>
	</td></tr>
      </table>
    </div>
  </body>
</html>
