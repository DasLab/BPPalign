%!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Write the variables necessary to create the dot plot.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define sequence length, scale, and translation factors.
/seqLength 304 def
/scaleFactorX 1.66667 def
/scaleFactorY 1.66667 def
/translateFactorX 21.6 def
/translateFactorY 129.6 def

% Define the size of the dots.
/dotSize 2 def

% Determine the number of grid lines in each direction.
/divisions 8 def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Write out the dot plot.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Create the legend array.
/legend [
    [(0.0153987 <= -log10(BP Probability) <  5.00009) 1.00 0.00 0.00]
    [(  5.00009 <= -log10(BP Probability) <  9.98479) 0.00 1.00 0.00]
    [(  9.98479 <= -log10(BP Probability) <= 14.9695) 0.00 0.00 1.00]
] def

% Show the legend.
/Courier-Bold findfont 8 scalefont setfont
36 300 moveto

legend { gsave aload pop setrgbcolor show grestore 0 -10 rmoveto } forall

% Write the plot description string.
/Courier-Bold findfont 12 scalefont setfont
36 72 moveto
(RA7680.pfs) show

% Write the translation and scaling of the main image.
gsave
scaleFactorX scaleFactorY scale
translateFactorX translateFactorY translate

% Write the triangle plot border.
newpath
0 seqLength moveto
seqLength seqLength lineto
seqLength 0 lineto
closepath
1 setlinewidth
stroke

% Write the gridline routine.
/gridline { newpath moveto lineto stroke } def

% Write the scale number placement routine.
/scaleNumber {
    gsave
    moveto
    rotate
    0 -5 rmoveto
    /increment 12 string def
    increment cvs
    increment show
    grestore
} def

% Write evenly spaced gridlines.
/Courier-Bold findfont 5 scalefont setfont
/counter 0 def
/number 1 def
divisions {
    /x 40 counter mul def
    /x2 seqLength x sub def
    /y seqLength 20 add def
    x y x y 20 sub x sub gridline
    y seqLength x sub x x2 gridline
    counter 0 ne { /number counter 10 mul def } if
    number 90 x seqLength 1 add scaleNumber
    number 0 seqLength 1 add x2 scaleNumber
    /counter counter 1 add def
} repeat

% Write end gridline if seq length isn't divisible by 10.
seqLength 10 mod 0 ne {
    seqLength y seqLength y 20 sub gridline
    seqLength 4 idiv 90 seqLength seqLength 1 add scaleNumber
    y 0 seqLength 0 gridline
    seqLength 4 idiv 0 seqLength 1 add 0 scaleNumber
} if

% Write the dot placement routine.
/dot {
    /x exch 4 mul 1 sub def
    /y exch 4 mul 1 sub def
    newpath
    /y seqLength y sub def
    x y moveto
    x y dotSize sub lineto
    x dotSize add y dotSize sub lineto
    x dotSize add y lineto
    closepath
    setrgbcolor
    fill
} def

% Write the values array.
/values [
  [0 1 0 1 12]
  [1 0 0 1 13]
  [0 1 0 1 28]
  [1 0 0 1 29]
  [1 0 0 1 32]
  [1 0 0 1 33]
  [0 0 1 1 50]
  [0 0 1 1 56]
  [0 0 1 1 62]
  [0 0 1 1 63]
  [0 1 0 1 69]
  [0 1 0 1 70]
  [0 1 0 1 71]
  [1 0 0 1 72]
  [1 0 0 1 75]
  [0 1 0 2 11]
  [1 0 0 2 12]
  [1 0 0 2 13]
  [0 1 0 2 27]
  [1 0 0 2 28]
  [1 0 0 2 29]
  [1 0 0 2 31]
  [1 0 0 2 32]
  [1 0 0 2 33]
  [0 0 1 2 49]
  [0 0 1 2 50]
  [0 0 1 2 55]
  [0 0 1 2 56]
  [0 0 1 2 61]
  [0 0 1 2 62]
  [0 0 1 2 63]
  [0 1 0 2 68]
  [0 1 0 2 69]
  [0 1 0 2 70]
  [1 0 0 2 71]
  [1 0 0 2 72]
  [1 0 0 2 74]
  [1 0 0 2 75]
  [1 0 0 3 11]
  [1 0 0 3 12]
  [1 0 0 3 13]
  [1 0 0 3 27]
  [1 0 0 3 28]
  [1 0 0 3 29]
  [1 0 0 3 31]
  [1 0 0 3 32]
  [1 0 0 3 33]
  [0 0 1 3 49]
  [0 0 1 3 50]
  [0 0 1 3 55]
  [0 0 1 3 56]
  [0 0 1 3 61]
  [0 0 1 3 62]
  [0 0 1 3 63]
  [0 1 0 3 68]
  [0 1 0 3 69]
  [1 0 0 3 70]
  [1 0 0 3 71]
  [1 0 0 3 72]
  [1 0 0 3 74]
  [1 0 0 3 75]
  [1 0 0 4 11]
  [1 0 0 4 12]
  [1 0 0 4 13]
  [1 0 0 4 27]
  [1 0 0 4 28]
  [1 0 0 4 29]
  [1 0 0 4 31]
  [1 0 0 4 32]
  [1 0 0 4 33]
  [0 0 1 4 49]
  [0 0 1 4 50]
  [0 0 1 4 55]
  [0 0 1 4 56]
  [0 0 1 4 61]
  [0 0 1 4 62]
  [0 0 1 4 63]
  [0 1 0 4 68]
  [1 0 0 4 69]
  [1 0 0 4 70]
  [1 0 0 4 71]
  [1 0 0 4 72]
  [1 0 0 4 74]
  [1 0 0 4 75]
  [1 0 0 5 11]
  [1 0 0 5 12]
  [0 1 0 5 20]
  [1 0 0 5 25]
  [1 0 0 5 27]
  [1 0 0 5 28]
  [1 0 0 5 31]
  [0 1 0 5 32]
  [1 0 0 5 36]
  [0 1 0 5 38]
  [0 1 0 5 40]
  [0 1 0 5 47]
  [0 0 1 5 49]
  [0 0 1 5 55]
  [0 0 1 5 61]
  [0 0 1 5 62]
  [0 1 0 5 66]
  [1 0 0 5 68]
  [1 0 0 5 69]
  [1 0 0 5 70]
  [1 0 0 5 71]
  [1 0 0 5 74]
  [1 0 0 6 10]
  [0 1 0 6 18]
  [0 1 0 6 19]
  [1 0 0 6 24]
  [1 0 0 6 26]
  [1 0 0 6 30]
  [1 0 0 6 35]
  [0 1 0 6 39]
  [0 1 0 6 41]
  [0 1 0 6 46]
  [0 0 1 6 51]
  [0 0 1 6 57]
  [0 1 0 6 64]
  [0 1 0 6 65]
  [1 0 0 6 67]
  [0 1 0 7 20]
  [1 0 0 7 25]
  [1 0 0 7 27]
  [1 0 0 7 29]
  [0 1 0 7 31]
  [0 1 0 7 33]
  [0 1 0 7 36]
  [0 1 0 7 38]
  [0 1 0 7 40]
  [0 1 0 7 47]
  [0 1 0 7 49]
  [0 1 0 7 50]
  [0 0 1 7 55]
  [0 0 1 7 56]
  [0 0 1 7 59]
  [0 1 0 7 61]
  [0 1 0 7 63]
  [1 0 0 7 66]
  [0 1 0 7 68]
  [0 1 0 7 74]
  [0 1 0 8 16]
  [0 1 0 8 18]
  [0 1 0 8 19]
  [1 0 0 8 21]
  [1 0 0 8 24]
  [1 0 0 8 26]
  [0 1 0 8 30]
  [0 1 0 8 35]
  [0 1 0 8 39]
  [0 1 0 8 41]
  [1 0 0 8 46]
  [1 0 0 8 48]
  [0 0 1 8 54]
  [0 1 0 8 60]
  [1 0 0 8 65]
  [0 1 0 8 67]
  [0 1 0 8 73]
  [1 0 0 9 20]
  [1 0 0 9 28]
  [1 0 0 9 32]
  [0 1 0 9 33]
  [0 1 0 9 38]
  [0 1 0 9 40]
  [1 0 0 9 47]
  [0 1 0 9 59]
  [0 1 0 9 70]
  [1 0 0 10 20]
  [1 0 0 10 25]
  [1 0 0 10 27]
  [1 0 0 10 31]
  [0 1 0 10 32]
  [0 1 0 10 36]
  [0 0 1 10 38]
  [0 1 0 10 40]
  [1 0 0 10 47]
  [0 1 0 10 66]
  [0 1 0 10 68]
  [0 1 0 10 69]
  [1 0 0 11 19]
  [1 0 0 11 22]
  [1 0 0 11 24]
  [1 0 0 11 26]
  [1 0 0 11 30]
  [0 1 0 11 35]
  [0 1 0 11 39]
  [1 0 0 11 43]
  [1 0 0 11 45]
  [1 0 0 11 46]
  [0 1 0 11 52]
  [0 1 0 11 53]
  [0 1 0 11 65]
  [0 1 0 11 67]
  [1 0 0 12 18]
  [1 0 0 12 19]
  [1 0 0 12 21]
  [1 0 0 12 23]
  [0 0 1 12 35]
  [1 0 0 12 42]
  [1 0 0 12 44]
  [1 0 0 12 45]
  [0 1 0 12 46]
  [0 1 0 12 51]
  [0 1 0 12 52]
  [0 1 0 12 53]
  [0 1 0 12 54]
  [0 1 0 12 64]
  [0 1 0 12 65]
  [1 0 0 13 18]
  [1 0 0 13 22]
  [0 1 0 13 39]
  [1 0 0 13 41]
  [1 0 0 13 43]
  [0 1 0 13 45]
  [0 1 0 13 51]
  [0 1 0 13 52]
  [0 1 0 13 53]
  [0 1 0 13 57]
  [0 1 0 13 64]
  [0 1 0 14 28]
  [0 1 0 14 32]
  [0 1 0 14 33]
  [0 1 0 14 38]
  [1 0 0 14 40]
  [0 0 1 14 70]
  [0 1 0 15 27]
  [1 0 0 15 29]
  [0 1 0 15 31]
  [0 1 0 15 32]
  [0 1 0 15 33]
  [0 1 0 15 56]
  [0 0 1 15 69]
  [0 1 0 15 71]
  [1 0 0 16 28]
  [0 1 0 16 32]
  [1 0 0 16 38]
  [1 0 0 16 40]
  [0 1 0 16 47]
  [0 1 0 16 55]
  [0 0 1 16 59]
  [0 1 0 16 70]
  [1 0 0 18 25]
  [0 1 0 18 28]
  [0 1 0 18 29]
  [0 1 0 18 32]
  [0 1 0 18 33]
  [1 0 0 18 36]
  [1 0 0 18 38]
  [0 1 0 18 40]
  [0 1 0 18 47]
  [0 1 0 18 50]
  [0 1 0 18 56]
  [0 0 1 18 59]
  [0 1 0 18 62]
  [0 1 0 18 63]
  [0 1 0 18 66]
  [0 1 0 18 69]
  [0 0 1 18 70]
  [0 1 0 18 71]
  [0 1 0 18 72]
  [1 0 0 18 75]
  [1 0 0 19 25]
  [0 1 0 19 27]
  [0 1 0 19 28]
  [0 1 0 19 31]
  [0 1 0 19 32]
  [1 0 0 19 36]
  [0 1 0 19 38]
  [0 1 0 19 40]
  [0 1 0 19 47]
  [1 0 0 19 49]
  [0 1 0 19 55]
  [0 0 1 19 59]
  [0 1 0 19 61]
  [0 1 0 19 62]
  [0 1 0 19 66]
  [0 1 0 19 68]
  [0 0 1 19 69]
  [0 0 1 19 70]
  [0 1 0 19 71]
  [1 0 0 19 74]
  [1 0 0 20 24]
  [0 1 0 20 26]
  [0 1 0 20 30]
  [1 0 0 20 35]
  [0 1 0 20 39]
  [0 1 0 20 41]
  [0 1 0 20 46]
  [1 0 0 20 48]
  [0 1 0 20 54]
  [0 1 0 20 60]
  [0 0 1 20 65]
  [0 1 0 20 67]
  [1 0 0 20 73]
  [0 1 0 21 28]
  [0 1 0 21 32]
  [1 0 0 21 33]
  [0 1 0 21 38]
  [0 1 0 21 40]
  [1 0 0 21 47]
  [0 1 0 21 59]
  [0 1 0 21 70]
  [0 1 0 22 27]
  [0 1 0 22 29]
  [0 1 0 22 31]
  [0 1 0 22 32]
  [1 0 0 22 33]
  [0 1 0 22 56]
  [0 1 0 22 69]
  [0 1 0 22 71]
  [0 1 0 23 28]
  [1 0 0 23 32]
  [0 1 0 23 33]
  [0 1 0 23 55]
  [0 1 0 23 70]
  [1 0 0 24 31]
  [0 1 0 24 32]
  [0 1 0 24 36]
  [0 1 0 24 38]
  [0 1 0 24 40]
  [1 0 0 24 47]
  [0 1 0 24 66]
  [0 1 0 24 68]
  [0 1 0 24 69]
  [1 0 0 25 30]
  [0 1 0 25 35]
  [0 1 0 25 39]
  [0 1 0 25 41]
  [1 0 0 25 46]
  [0 1 0 25 51]
  [0 1 0 25 57]
  [0 1 0 25 64]
  [0 1 0 25 65]
  [0 1 0 25 67]
  [0 1 0 26 33]
  [0 1 0 26 36]
  [0 1 0 26 38]
  [0 1 0 26 40]
  [1 0 0 26 47]
  [0 1 0 26 50]
  [0 1 0 26 56]
  [0 1 0 26 63]
  [0 1 0 26 66]
  [0 1 0 26 68]
  [0 1 0 27 35]
  [1 0 0 27 39]
  [1 0 0 27 43]
  [1 0 0 27 45]
  [1 0 0 27 46]
  [0 1 0 27 52]
  [0 1 0 27 53]
  [0 1 0 27 65]
  [0 1 0 27 67]
  [0 1 0 28 35]
  [1 0 0 28 42]
  [1 0 0 28 44]
  [1 0 0 28 45]
  [1 0 0 28 46]
  [0 1 0 28 51]
  [0 1 0 28 52]
  [0 0 1 28 53]
  [0 1 0 28 54]
  [0 1 0 28 64]
  [0 1 0 28 65]
  [0 1 0 29 39]
  [1 0 0 29 41]
  [1 0 0 29 43]
  [1 0 0 29 45]
  [0 1 0 29 51]
  [0 0 1 29 52]
  [0 1 0 29 53]
  [0 0 1 29 57]
  [0 1 0 29 64]
  [0 1 0 29 67]
  [1 0 0 30 36]
  [0 1 0 30 38]
  [1 0 0 30 40]
  [1 0 0 30 47]
  [0 1 0 30 50]
  [0 0 1 30 56]
  [0 1 0 30 63]
  [0 1 0 30 66]
  [0 0 1 30 68]
  [1 0 0 31 35]
  [1 0 0 31 39]
  [1 0 0 31 43]
  [0 1 0 31 45]
  [1 0 0 31 46]
  [0 1 0 31 52]
  [0 0 1 31 53]
  [0 1 0 31 65]
  [0 0 1 31 67]
  [1 0 0 32 42]
  [0 1 0 32 43]
  [0 1 0 32 44]
  [1 0 0 32 45]
  [0 1 0 32 46]
  [0 1 0 32 51]
  [0 0 1 32 52]
  [0 0 1 32 53]
  [0 0 1 32 54]
  [0 0 1 32 64]
  [0 0 1 32 65]
  [1 0 0 33 39]
  [1 0 0 33 41]
  [0 1 0 33 42]
  [0 1 0 33 43]
  [1 0 0 33 44]
  [0 1 0 33 45]
  [0 1 0 33 48]
  [0 0 1 33 51]
  [0 0 1 33 52]
  [0 0 1 33 53]
  [0 0 1 33 57]
  [0 0 1 33 60]
  [0 0 1 33 64]
  [0 0 1 33 67]
  [0 1 0 33 73]
  [0 1 0 33 76]
  [0 1 0 35 47]
  [0 1 0 35 49]
  [0 0 1 35 55]
  [0 0 1 35 61]
  [0 0 1 35 62]
  [0 1 0 35 66]
  [0 1 0 35 68]
  [0 0 1 35 69]
  [0 1 0 35 70]
  [0 1 0 35 71]
  [1 0 0 35 74]
  [0 1 0 36 46]
  [0 0 1 36 51]
  [0 0 1 36 57]
  [0 0 1 36 64]
  [0 1 0 36 65]
  [0 1 0 36 67]
  [0 1 0 38 46]
  [0 1 0 38 48]
  [0 1 0 38 51]
  [0 0 1 38 54]
  [0 0 1 38 57]
  [0 0 1 38 60]
  [0 1 0 38 64]
  [0 0 1 38 65]
  [0 0 1 38 67]
  [1 0 0 38 73]
  [1 0 0 38 76]
  [0 1 0 39 47]
  [0 1 0 39 49]
  [0 1 0 39 50]
  [0 0 1 39 55]
  [0 0 1 39 56]
  [0 0 1 39 59]
  [0 1 0 39 61]
  [0 1 0 39 63]
  [0 1 0 39 66]
  [0 1 0 39 68]
  [1 0 0 39 72]
  [1 0 0 39 74]
  [1 0 0 39 75]
  [0 1 0 40 46]
  [0 1 0 40 48]
  [0 1 0 40 51]
  [0 0 1 40 54]
  [0 1 0 40 57]
  [0 1 0 40 60]
  [0 1 0 40 64]
  [0 1 0 40 65]
  [0 1 0 40 67]
  [1 0 0 40 73]
  [1 0 0 40 76]
  [0 1 0 41 47]
  [0 1 0 41 50]
  [0 1 0 41 56]
  [0 1 0 41 59]
  [0 1 0 41 63]
  [0 1 0 41 66]
  [0 1 0 41 71]
  [1 0 0 41 72]
  [1 0 0 41 75]
  [0 1 0 42 55]
  [0 1 0 42 70]
  [0 1 0 43 56]
  [0 1 0 43 69]
  [1 0 0 43 71]
  [0 1 0 44 55]
  [1 0 0 44 70]
  [0 1 0 45 56]
  [1 0 0 45 62]
  [1 0 0 45 63]
  [1 0 0 45 69]
  [0 1 0 45 70]
  [0 1 0 45 71]
  [0 1 0 45 72]
  [0 1 0 45 75]
  [0 1 0 46 55]
  [0 1 0 46 59]
  [1 0 0 46 61]
  [1 0 0 46 62]
  [1 0 0 46 66]
  [1 0 0 46 68]
  [0 1 0 46 69]
  [0 1 0 46 70]
  [0 1 0 46 71]
  [0 1 0 46 74]
  [0 1 0 47 54]
  [1 0 0 47 60]
  [0 1 0 47 65]
  [1 0 0 47 67]
  [0 1 0 47 73]
  [1 0 0 48 59]
  [1 0 0 49 65]
  [1 0 0 50 57]
  [1 0 0 50 64]
  [0 1 0 50 67]
  [1 0 0 51 56]
  [1 0 0 51 62]
  [1 0 0 51 63]
  [0 1 0 51 66]
  [0 1 0 51 69]
  [0 0 1 51 70]
  [0 0 1 51 71]
  [0 0 1 51 72]
  [0 0 1 51 75]
  [1 0 0 52 61]
  [1 0 0 52 62]
  [1 0 0 52 63]
  [0 1 0 52 68]
  [0 0 1 52 69]
  [0 0 1 52 70]
  [0 0 1 52 71]
  [0 0 1 52 72]
  [0 0 1 52 74]
  [0 0 1 52 75]
  [1 0 0 53 61]
  [1 0 0 53 62]
  [0 0 1 53 68]
  [0 0 1 53 69]
  [0 0 1 53 70]
  [0 0 1 53 71]
  [0 0 1 53 74]
  [0 0 1 54 70]
  [0 1 0 55 65]
  [0 1 0 56 64]
  [0 0 1 56 67]
  [0 1 0 57 63]
  [0 1 0 57 66]
  [0 0 1 57 71]
  [0 0 1 64 70]
  [0 0 1 64 71]
  [0 1 0 64 72]
  [0 0 1 64 75]
  [0 0 1 65 69]
  [0 0 1 65 70]
  [0 1 0 65 71]
  [0 0 1 65 74]
] def

% Write the for loop that shows the dots.
values { aload pop dot } forall

% Restore the original scaling to 100%.
grestore

showpage
